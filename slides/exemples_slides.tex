\part{EXEMPLES RÉSOLUS}

\begin{frame}
  \partpage
\end{frame}

\begin{frame}
  \frametitle{Sommaire}
  \tableofcontents
\end{frame}


\section{Calcul de valeurs présentes}

\begin{frame}
  \frametitle{Calcul de valeurs présentes}

  \begin{block}{Énoncé}
    Un prêt est remboursé par une série de cinq paiements, le premier
    dans un an. Trouver le montant du prêt pour chacune des hypothèses
    ci-dessous.
    \begin{enumerate}[(a)]
    \item Paiement annuel de \nombre{1000}, taux d'intérêt de 6~\%
      effectif annuellement.
    \item Paiements annuels de 500, 800, 900, 750 et \nombre{1000},
      taux d'intérêt de 6~\% effectif annuellement.
    \item Paiements annuels de 500, 800, 900, 750 et \nombre{1000},
      taux d'intérêt de 5~\%, 6~\%, 5,5~\%, 6,5~\% et 7~\% effectifs
      annuellement.
    \end{enumerate}
  \end{block}
\end{frame}

\begin{frame}
  \frametitle{Solution}
  De manière générale, la valeur présente d'une série de paiements
  $P_1, P_2, \dots, P_n$ à la fin des années $1, 2, \dots, n$ est
  \begin{displaymath}
    \sum_{j=1}^n \prod_{k=1}^j (1 + i_k)^{-1} P_j,
  \end{displaymath}
\end{frame}

\begin{frame}[fragile]
  \NoAutoSpaceBeforeFDP
  \begin{proof}[(a) Un seul paiement annuel, un seul taux d'intérêt]
    Cas spécial
    \begin{displaymath}
      \color{orange}P \color{blue} \sum_{j=1}^n \color{red}(1 + i)^{-j}
    \end{displaymath}
    En S:
    \pause
\begin{semiverbatim} \slshape
> \uncover<4->{\color{orange}1000 * }\uncover<3->{\color{blue}sum(}{\color{red}(1 + 0.06)^(-(1:5))}\uncover<3->{)}
\end{semiverbatim}
    \onslide<5->
\begin{Soutput}
[1] 4212.364
\end{Soutput}
  \end{proof}
\end{frame}

\begin{frame}[fragile]
  \NoAutoSpaceBeforeFDP
  \begin{proof}[(b) Différents paiements annuels, un seul taux d'intérêt]
    On a, cette fois,
    \begin{displaymath}
      \color{blue} \sum_{j=1}^n \color{red}(1 + i)^{-j} \color{orange}P_j 
    \end{displaymath}
    En S:
    \pause
\begin{semiverbatim}
> \uncover<3->{\color{blue}sum(}\color{orange}c(500, 800, 900, 750, 1000) *
\normalcolor+     \color{red}(1 + 0.06)^(-(1:5))\uncover<3->{\color{blue})}
\end{semiverbatim}
    \onslide<4->
\begin{Soutput}
[1] 3280.681
\end{Soutput}
  \end{proof}
\end{frame}

\begin{frame}[fragile]
  \begin{proof}[(c) Différents paiements annuels, différents taux d'intérêt]
    On doit utiliser la formule générale
    \begin{displaymath}
      \color{blue}\sum_{j=1}^n 
      \color{red} \prod_{k=1}^j (1 + i_k)^{-1} 
      \color{orange} P_j
    \end{displaymath}
    En S:
    \pause
\begin{semiverbatim}
> \uncover<4->{\color{blue}sum(}\uncover<3->{\color{orange}c(500, 800, 900, 750, 1000)/}
\normalcolor+ \color{red}cumprod(c(1.05, 1.06, 1.055, 1.065, 1.07))\uncover<4->{\color{blue})}
\end{semiverbatim}
    \onslide<5->
\begin{Soutput}
[1] 3308.521
\end{Soutput}
  \end{proof}
\end{frame}

\section{Fonctions de probabilité}
\label{exemples:fp}

\begin{frame}
  \frametitle{Fonctions de probabilité}

  \begin{block}{Énoncé}
    Calculer toutes ou la majeure partie des probabilités des deux
    lois de probabilité ci-dessous. Vérifier que la somme des
    probabilités est bien égale à 1.

    \begin{enumerate}[(a)]
    \item Binomiale
      \begin{displaymath}
        f(x) = \binom{n}{x} p^x (1 - p)^{n - x}, \quad x = 0, \dots, n.
      \end{displaymath}
    \item Poisson
      \begin{displaymath}
        f(x) = \frac{\lambda^x e^{-\lambda}}{x!}, \quad x = 0, 1, \dots,
      \end{displaymath}
      où $x! = x(x - 1) \cdots 2 \cdot 1$.
    \end{enumerate}
  \end{block}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Solution}

  \begin{proof}[(a) Binomiale$(10,\, 0,8)$]
\begin{Schunk}
\begin{Sinput}
> n <- 10
> p <- 0.8
> x <- 0:n
> choose(n, x) * p^x * (1 - p)^rev(x)
\end{Sinput}
\begin{Soutput}
 [1] 0.0000001024 0.0000040960 0.0000737280
 [4] 0.0007864320 0.0055050240 0.0264241152
 [7] 0.0880803840 0.2013265920 0.3019898880
[10] 0.2684354560 0.1073741824
\end{Soutput}
\end{Schunk}
    \pause
\begin{Schunk}
\begin{Sinput}
> sum(choose(n, x) * p^x * (1 - p)^rev(x))
\end{Sinput}
\begin{Soutput}
[1] 1
\end{Soutput}
\end{Schunk}
  \end{proof}
\end{frame}

\begin{frame}[fragile]
  \begin{proof}[(b) Poisson$(5)$]
    On calcule les probabilités en $x = 0, 1, \dots, 10$ seulement.
\begin{Schunk}
\begin{Sinput}
> lambda <- 5
> x <- 0:10
> exp(-lambda) * (lambda^x/factorial(x))
\end{Sinput}
\begin{Soutput}
 [1] 0.006737947 0.033689735 0.084224337
 [4] 0.140373896 0.175467370 0.175467370
 [7] 0.146222808 0.104444863 0.065278039
[10] 0.036265577 0.018132789
\end{Soutput}
\end{Schunk}
  \pause
\begin{Schunk}
\begin{Sinput}
> x <- 0:200
> exp(-lambda) * sum((lambda^x/factorial(x)))
\end{Sinput}
\begin{Soutput}
[1] 1
\end{Soutput}
\end{Schunk}
  \end{proof}
\end{frame}


\section{Fonction de répartition de la loi gamma}

\begin{frame}
  \frametitle{Fonction de répartition de la loi gamma}

  La loi gamma est fréquemment utilisée pour la modélisation
  d'événements ne pouvant prendre que des valeurs positives et pour
  lesquels les petites valeurs sont plus fréquentes que les grandes.

  Nous utiliserons la paramétrisation où la fonction de densité de
  probabilité est
  \begin{displaymath}
    f(x) = \frac{\lambda^\alpha}{\Gamma(\alpha)}\, x^{\alpha-1}
    e^{-\lambda x}, \quad x > 0,
  \end{displaymath}
  où
  \begin{displaymath}
    \Gamma(n) = \int_0^\infty x^{n - 1} e^{-x}\, dx
    = (n - 1) \Gamma(n - 1).
  \end{displaymath}
\end{frame}

\begin{frame}[label=frgamma]
  \begin{block}{Énoncé}
    Il n'existe pas de formule explicite de la fonction de répartition
    de la loi gamma. 

    Néanmoins, pour $\alpha$ entier et $\lambda = 1$ on a
    \begin{displaymath}
      F(x; \alpha, 1) = 1 - e^{-x} \sum_{j=0}^{\alpha-1} \frac{x^j}{j!}.
    \end{displaymath}

    \begin{enumerate}[(a)]
    \item Évaluer $F(4; 5, 1)$.
    \item Évaluer $F(x; 5, 1)$ pour $x = 2, 3, \dots, 10$ en une seule
      expression.
    \end{enumerate}
  \end{block}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Solution}

  \begin{proof}[(a) Une seule valeur de $x$, paramètre $\alpha$ fixe]
\begin{Schunk}
\begin{Sinput}
> alpha <- 5
> x <- 4
> 1 - exp(-x) * sum(x^(0:(alpha - 1))/
+ gamma(1:alpha))
\end{Sinput}
\begin{Soutput}
[1] 0.3711631
\end{Soutput}
\end{Schunk}
  \pause
  Vérification avec la fonction interne \fonction{pgamma}:
\begin{Schunk}
\begin{Sinput}
> pgamma(x, alpha)
\end{Sinput}
\begin{Soutput}
[1] 0.3711631
\end{Soutput}
\end{Schunk}
  \end{proof}
\end{frame}

\begin{frame}[fragile]
  \begin{alertblock}{Astuce}
    On peut aussi éviter de générer essentiellement la même suite de
    nombres à deux reprises en ayant recours à une variable
    intermédiaire. 

    L'affectation et le calcul final peuvent se faire dans une
    seule expression.
\begin{Schunk}
\begin{Sinput}
> 1 - exp(-x) * sum(x^(-1 + (j <- 1:alpha))/
+ gamma(j))
\end{Sinput}
\begin{Soutput}
[1] 0.3711631
\end{Soutput}
\end{Schunk}
  \end{alertblock}
\end{frame}

\begin{frame}[fragile]
  \begin{proof}[(b) Plusieurs valeurs de $x$, paramètre $\alpha$ fixe]
    C'est un travail pour la fonction \fonction{outer}.
\begin{Schunk}
\begin{Sinput}
> x <- 2:10
> 1 - exp(-x) * 
+ colSums(
+   t( outer(x, 0:(alpha - 1), "^") )
+   /gamma(1:alpha)
+ )
\end{Sinput}
\begin{Soutput}
[1] 0.05265302 0.18473676 0.37116306
[4] 0.55950671 0.71494350 0.82700839
[7] 0.90036760 0.94503636 0.97074731
\end{Soutput}
\end{Schunk}
  \end{proof}
\end{frame}

\againframe{frgamma}


\section{Algorithme du point fixe}

\begin{frame}
  \frametitle{Algorithme du point fixe}

  \begin{itemize}[<+->]
  \item Problème classique: trouver la racine d'une fonction $g$,
    c'est-à-dire le point $x$ où $g(x) = 0$.
  \item Souvent possible de reformuler le problème de façon à plutôt
    chercher le point $x$ où $f(x) = x$.
  \item Solution appelée \alert{point fixe}.
  \item L'algorithme du calcul numérique du point fixe d'une fonction
    $f(x)$ est très simple:
    \begin{enumerate}
    \item choisir une valeur de départ $x_0$;
    \item calculer $x_n = f(x_{n-1})$;
    \item répéter l'étape 2 jusqu'à ce que $|x_n - x_{n-1}| < \varepsilon$
      ou $|x_n - x_{n-1}|/|{x_{n-1}}| < \varepsilon$.
    \end{enumerate}
  \end{itemize}
\end{frame}

\begin{frame}
  \begin{block}{Énoncé}
    Trouver, à l'aide de la méthode du point fixe, la valeur de $i$
    telle que
    \begin{displaymath}
      a_{\angl{10}} = \frac{1 - (1 + i)^{-10}}{i} = 8,21.
    \end{displaymath}
  \end{block}
\end{frame}

\begin{frame}
  \frametitle{Solution}

  \begin{block}{Quelques considérations.}
    \begin{itemize}[<+->]
    \item On doit résoudre
      \begin{displaymath}
        \frac{1 - (1 + i)^{-10}}{8,21} = i.
      \end{displaymath}
    \item Nous ignorons combien de fois la procédure itérative devra
      être répétée.
    \item Il faut exécuter la procédure au moins une fois.
    \item La structure de contrôle à utiliser dans cette procédure
      itérative est donc \fonction{\alert{repeat}}.
    \end{itemize}
  \end{block}
\end{frame}

\begin{frame}[fragile]
  \begin{proof}[Le code]
\begin{Schunk}
\begin{Sinput}
> i <- 0.05
> repeat {
+     it <- i
+     i <- (1 - (1 + it)^(-10))/8.21
+     if (abs(i - it)/it < 1e-10) 
+         break
+ }
> i
\end{Sinput}
\begin{Soutput}
[1] 0.03756777
\end{Soutput}
\end{Schunk}
  \pause
\begin{Schunk}
\begin{Sinput}
> (1 - (1 + i)^(-10))/i
\end{Sinput}
\begin{Soutput}
[1] 8.21
\end{Soutput}
\end{Schunk}
  \end{proof}
\end{frame}
%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "introduction_programmation_S_slides"
%%% End: 
